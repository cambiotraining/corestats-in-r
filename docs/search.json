[{},{"path":"index.html","id":"overview","chapter":"1 Overview","heading":"1 Overview","text":"sessions intended enable perform core data analysis techniques appropriately confidently using R.6 lecture-practicals6 lecture-practicalsOngoing formative assessment exercisesOngoing formative assessment exercisesNo formal assessmentNo formal assessmentNo mathematical derivationsNo mathematical derivationsNo pen paper calculationsNo pen paper calculationsThey “mindlessly use stats program” course!","code":""},{"path":"index.html","id":"core-aims","chapter":"1 Overview","heading":"1.1 Core aims","text":"know presented arbitrary dataset e.g.Know data analysis techniques availableKnow ones allowableBe able carry understand results","code":""},{"path":"index.html","id":"core-topics","chapter":"1 Overview","heading":"1.2 Core topics","text":"Simple hypothesis testingCategorical predictor variablesContinuous predictorsTwo predictor variablesMultiple predictor variablesPower analysis","code":""},{"path":"index.html","id":"practicals","chapter":"1 Overview","heading":"1.3 Practicals","text":"practical document divided various sections. section explanatory text help understand going ’re trying achieve.\nmay list commands relevant section displayed boxes like :Conditional operatorsTo set filtering conditions, use following relational operators:> greater >= greater equal < less <= less equal == equal != different %% contained combine conditions, use following logical operators:& | ","code":""},{"path":"index.html","id":"index-datasets","chapter":"1 Overview","heading":"1.4 Datasets","text":"course uses various data sets. easiest way accessing creating R-project RStudio. download data folder right-clicking link Save …. Next unzip file copy working directory. data accessible via <working-directory-name>/data/tidy.","code":""},{},{"path":"cs4-intro.html","id":"cs4-intro","chapter":"2 Introduction","heading":"2 Introduction","text":"","code":""},{"path":"cs4-intro.html","id":"objectives","chapter":"2 Introduction","heading":"2.1 Objectives","text":"Aim: introduce R commands carrying two-way ANOVA linear regression grouped data/ANCOVABy end practical participants able achieve following:Carry two-way ANOVA using R interpret outputAnalyse linear regression grouped data (ANCOVA)","code":""},{"path":"cs4-intro.html","id":"background","chapter":"2 Introduction","heading":"2.2 Background","text":"practical focuses implementation various statistical tests relating multiple predictor variables R. focus underlying theory tests (although demonstrators happy answer questions may ).test section explaining perform test, section explaining results output screen, exercise complete relating test .","code":""},{},{"path":"introduction.html","id":"introduction","chapter":"3 Introduction","heading":"3 Introduction","text":"","code":""},{"path":"introduction.html","id":"cs4-datasets","chapter":"3 Introduction","heading":"3.1 Datasets","text":"section uses various data sets. located data/raw/ folder working directory. Please see Datasets information.","code":""},{},{"path":"two-way-anova.html","id":"two-way-anova","chapter":"4 Two-way ANOVA","heading":"4 Two-way ANOVA","text":"","code":""},{"path":"two-way-anova.html","id":"objectives-1","chapter":"4 Two-way ANOVA","heading":"4.1 Objectives","text":"QuestionsWhen use two-way ANOVA appropriate?perform R?ObjectivesBe able perform two-way ANOVA RUnderstand concept interaction two predictor variablesBe able plot interactions R","code":""},{"path":"two-way-anova.html","id":"purpose-and-aim","chapter":"4 Two-way ANOVA","heading":"4.2 Purpose and aim","text":"two-way analysis variance used two categorical predictor variables (factors) single continuous response variable. example, looking body weight (continuous response variable kilograms) affected sex (categorical variable, Male Female) exercise type (categorical variable, Control Runner).analysing type data two things want know:either predictor variables effect response variable .e. sex affect body weight? runner affect body weight?interaction two predictor variables? interaction mean effect exercise weight depends whether male female rather independent sex. example male means runners weigh non-runners, female means runners weight less non-runners say interaction.first consider visualise data carrying appropriate statistical test.","code":""},{"path":"two-way-anova.html","id":"section-commands","chapter":"4 Two-way ANOVA","heading":"4.3 Section commands","text":"New commands used section:","code":""},{"path":"two-way-anova.html","id":"data-and-hypotheses","chapter":"4 Two-way ANOVA","heading":"4.4 Data and hypotheses","text":"recreate example analysis used lecture. data stored .csv file called data/tidy/CS4-exercise.csv.","code":""},{"path":"two-way-anova.html","id":"summarise-and-visualise","chapter":"4 Two-way ANOVA","heading":"4.5 Summarise and visualise","text":"exercise data frame three variables; weight, sex exercise. weight continuous response variable, whereas sex exercise categorical predictor variables.First, read data:visualise:produce box plots showing response variable (weight) terms one predictor variables. values predictor variable case aren’t taken account.(Optional) Add titles, axis labels information see fit plots make presentable.Visualise predictor variables together:produces box plots (four) combinations predictor variables. plotting sex x-axis; weight y-axis filling box plot exercise regime.’ve also changed default colouring scheme, using scale_fill_brewer(palette = \"Dark2\"). uses colour-blind friendly colour palette (Brewer colour pallete ).(Optional) Add titles, axis labels information see fit plot make presentable.example four box plots relatively easy compare look interactions variables, two groups per categorical variable, become harder spot going .compare categorical variables easily can just plot group means aids ability look interactions main effects predictor variable.Create interaction plot:plot weight y-axis, sex x-axis.colour data exercise regime group data exercise work mean values groupgeom_point() displays datastat_summary(fun = mean)calculates mean groupscale_colour_brewer() lets us define colour paletteThe choice categorical factor plotted horizontal axis plotted different lines completely arbitrary. Looking data ways shouldn’t add anything often ’ll find prefer one plot another.Plot interaction plot way round:now good feeling data already provide guesses following three questions:appear interaction two categorical variables?:\nexercise effect weight?\nsex effect weight?\nexercise effect weight?sex effect weight?can now attempt answer three questions formally using ANOVA test. ask R explicitly test three things: interaction, effect exercise effect sex.","code":"\nexercise <- read_csv(\"data/tidy/CS4-exercise.csv\")\n# visualise the data, sex vs weight\nexercise %>% \n  ggplot(aes(x = sex, y = weight)) +\n  geom_boxplot()\n# visualise the data, exercise vs weight\nexercise %>% \n  ggplot(aes(x = exercise, y = weight)) +\n  geom_boxplot()\nexercise %>% \n  ggplot(aes(x = sex, y = weight, fill = exercise)) +\n  geom_boxplot() +\n  scale_fill_brewer(palette = \"Dark2\")\nexercise %>% \n  ggplot(aes(x = sex,\n             y = weight,\n             colour = exercise, group = exercise)) +\n  geom_point() +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\nexercise %>% \n  ggplot(aes(x = exercise,\n             y = weight,\n             colour = sex, group = sex)) +\n  geom_point() +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")"},{"path":"two-way-anova.html","id":"assumptions","chapter":"4 Two-way ANOVA","heading":"4.6 Assumptions","text":"can formally test things first need define model check underlying assumptions. use following code define model:sex:exercise term R represents concept interaction two variables.two-way ANOVA type linear model need satisfy pretty much assumptions simple linear regression one-way ANOVA:data must systematic pattern itThe residuals must normally distributedThe residuals must homogeneity varianceThe fit depend overly much single point (point high leverage)., check assumptions visually producing four key diagnostic plots.Residual plot shows residuals predicted values. systematic pattern plot pretty good.Q-Q plot allows visual inspection normality. , looks OK (perfect OK).Location-Scale plot allows us investigate whether homogeneity variance. plot fine (perfect fine).Cook’s D plot shows individual point high influence model (values well 0.5)shorthand way writing:weight ~ sex + exercise + sex:exerciseIf use following syntax:weight ~ sex * exerciseThen R interprets exactly way writing three terms.\ncan see compare output following two commands:","code":"\n# define the linear model\nlm_exercise <- lm(weight ~ sex + exercise + sex:exercise,\n                  data = exercise)\nlm_exercise %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)\nanova(lm(weight ~ sex + exercise + sex:exercise,\n         data = exercise))## Analysis of Variance Table\n## \n## Response: weight\n##              Df Sum Sq Mean Sq F value    Pr(>F)    \n## sex           1 607.20  607.20 43.1144 6.493e-06 ***\n## exercise      1 184.83  184.83 13.1240  0.002287 ** \n## sex:exercise  1  82.42   82.42  5.8521  0.027839 *  \n## Residuals    16 225.34   14.08                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nanova(lm(weight ~ sex * exercise,\n         data = exercise))## Analysis of Variance Table\n## \n## Response: weight\n##              Df Sum Sq Mean Sq F value    Pr(>F)    \n## sex           1 607.20  607.20 43.1144 6.493e-06 ***\n## exercise      1 184.83  184.83 13.1240  0.002287 ** \n## sex:exercise  1  82.42   82.42  5.8521  0.027839 *  \n## Residuals    16 225.34   14.08                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"implement-the-test","chapter":"4 Two-way ANOVA","heading":"4.7 Implement the test","text":"assumptions appear met well enough, meaning can implement ANOVA. follows (probably easiest bit!):","code":"\n# perform the ANOVA\nanova(lm_exercise)"},{"path":"two-way-anova.html","id":"interpret-output-and-present-results","chapter":"4 Two-way ANOVA","heading":"4.8 Interpret output and present results","text":"Performing ANOVA gives us following output:row table different effects ’ve asked R consider. last column important one contains p-values (although also need F-values degrees freedom reporting purposes). need look interaction row first.sex:exercise p-value 0.028 (smaller 0.05) can conclude interaction sex exercise significant.must stop.top two lines (corresponding effects sex exercise) meaningless now p-values reported utterly redundant (particular way care p-values small).model significant interaction logically impossible meaningfully interpret main effects.report follows:two-way ANOVA test showed significant interaction effects sex Exercise Weight (F = 5.8521, df = 1,16, p = 0.028). Exercise associated small loss weight males larger loss weight females.","code":"## Analysis of Variance Table\n## \n## Response: weight\n##              Df Sum Sq Mean Sq F value    Pr(>F)    \n## sex           1 607.20  607.20 43.1144 6.493e-06 ***\n## exercise      1 184.83  184.83 13.1240  0.002287 ** \n## sex:exercise  1  82.42   82.42  5.8521  0.027839 *  \n## Residuals    16 225.34   14.08                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"exercise-cells","chapter":"4 Two-way ANOVA","heading":"4.9 Exercise: Cells","text":"Exercise 4.1  Cell growthThese data/tidy/CS4-cells.csv data fictional experiment involves looking effect different concentrations substance growth rate two different cell types (annoyingly vague know – suggestions context welcome !). two cell types three concentrations.cell type control experiment substance added (.e. concentration none); low concentration substance high concentration substance. cells called B.\ncombination cell type substance concentration add substance individual cell petri dish 8 hours, count number cells dish (may well biologically weird/impossible – suggestions welcome). experiment repeated three times.cell type control experiment substance added (.e. concentration none); low concentration substance high concentration substance. cells called B.\ncombination cell type substance concentration add substance individual cell petri dish 8 hours, count number cells dish (may well biologically weird/impossible – suggestions welcome). experiment repeated three times.Questions answer:Visualise data using boxplots interaction plots.appear interaction?Carry two-way ANOVA test.Check assumptions.can conclude? (Write sentence summarise).Let’s look interaction plots. ’re omitting actual data just plotting mean values:’re constructed box plots ’ve also constructed two interaction plots. needed one interaction plot find can quite useful look data different angles. interaction plots suggest interaction lines plots aren’t parallel. Looking interaction plot concentration x-axis, appears non-difference cell types concentration none, difference cell types concentration low high.First need define model:Next, check assumptions:, actually look pretty good, although first glance might bit worried apparent heterogeneity variance. last group Residual plot appear spread 5 groups. echoed Location-Scale plot, red line kicks end. Whilst technically signify heterogeneity variance aren’t worried three data points per group. low number data points per group get one data point little bit extreme others (purely chance) large impact perception homogeneity variance. data points group certain observed heterogeneity variance true feature underlying parent population (therefore problem) rather just caused single random point (therefore problem).Let’s carry two-way ANOVA:definitely significant interaction concentration cell_type.","code":"\n# read in the data\ncells <- read_csv(\"data/tidy/CS4-cells.csv\")\n\n# let's have a peek at the data\ncells## # A tibble: 18 × 4\n##       id cell_type concentration cell_number\n##    <dbl> <chr>     <chr>               <dbl>\n##  1     1 A         none                    7\n##  2     2 A         none                    9\n##  3     3 A         none                    4\n##  4     4 B         none                    5\n##  5     5 B         none                    8\n##  6     6 B         none                    9\n##  7     7 A         low                    22\n##  8     8 A         low                    28\n##  9     9 A         low                    26\n## 10    10 B         low                    12\n## 11    11 B         low                    17\n## 12    12 B         low                    14\n## 13    13 A         high                   89\n## 14    14 A         high                   78\n## 15    15 A         high                   83\n## 16    16 B         high                   48\n## 17    17 B         high                   44\n## 18    18 B         high                   45\ncells %>% \n  ggplot(aes(x = concentration, y = cell_number)) +\n  geom_boxplot()\ncells %>% \n  ggplot(aes(x = cell_type, y = cell_number)) +\n  geom_boxplot()\n# by cell type\ncells %>% \n  ggplot(aes(x = concentration,\n             y = cell_number,\n             colour = cell_type, group = cell_type)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# by concentration\ncells %>% \n  ggplot(aes(x = cell_type,\n             y = cell_number,\n             colour = concentration, group = concentration)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# define the linear model, with interaction term\nlm_cells <- lm(cell_number ~ concentration * cell_type,\n          data = cells)\nlm_cells %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)\n# perform the ANOVA\nanova(lm_cells)## Analysis of Variance Table\n## \n## Response: cell_number\n##                         Df  Sum Sq Mean Sq F value    Pr(>F)    \n## concentration            2 10932.1  5466.1 537.645 1.807e-12 ***\n## cell_type                1  1152.0  1152.0 113.311 1.816e-07 ***\n## concentration:cell_type  2  1158.3   579.2  56.967 7.485e-07 ***\n## Residuals               12   122.0    10.2                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"load-the-data","chapter":"4 Two-way ANOVA","heading":"4.9.1 Load the data","text":"","code":"\n# read in the data\ncells <- read_csv(\"data/tidy/CS4-cells.csv\")\n\n# let's have a peek at the data\ncells## # A tibble: 18 × 4\n##       id cell_type concentration cell_number\n##    <dbl> <chr>     <chr>               <dbl>\n##  1     1 A         none                    7\n##  2     2 A         none                    9\n##  3     3 A         none                    4\n##  4     4 B         none                    5\n##  5     5 B         none                    8\n##  6     6 B         none                    9\n##  7     7 A         low                    22\n##  8     8 A         low                    28\n##  9     9 A         low                    26\n## 10    10 B         low                    12\n## 11    11 B         low                    17\n## 12    12 B         low                    14\n## 13    13 A         high                   89\n## 14    14 A         high                   78\n## 15    15 A         high                   83\n## 16    16 B         high                   48\n## 17    17 B         high                   44\n## 18    18 B         high                   45"},{"path":"two-way-anova.html","id":"visualise-the-data","chapter":"4 Two-way ANOVA","heading":"4.9.2 Visualise the data","text":"Let’s look interaction plots. ’re omitting actual data just plotting mean values:’re constructed box plots ’ve also constructed two interaction plots. needed one interaction plot find can quite useful look data different angles. interaction plots suggest interaction lines plots aren’t parallel. Looking interaction plot concentration x-axis, appears non-difference cell types concentration none, difference cell types concentration low high.","code":"\ncells %>% \n  ggplot(aes(x = concentration, y = cell_number)) +\n  geom_boxplot()\ncells %>% \n  ggplot(aes(x = cell_type, y = cell_number)) +\n  geom_boxplot()\n# by cell type\ncells %>% \n  ggplot(aes(x = concentration,\n             y = cell_number,\n             colour = cell_type, group = cell_type)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# by concentration\ncells %>% \n  ggplot(aes(x = cell_type,\n             y = cell_number,\n             colour = concentration, group = concentration)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")"},{"path":"two-way-anova.html","id":"assumptions-1","chapter":"4 Two-way ANOVA","heading":"4.9.3 Assumptions","text":"First need define model:Next, check assumptions:, actually look pretty good, although first glance might bit worried apparent heterogeneity variance. last group Residual plot appear spread 5 groups. echoed Location-Scale plot, red line kicks end. Whilst technically signify heterogeneity variance aren’t worried three data points per group. low number data points per group get one data point little bit extreme others (purely chance) large impact perception homogeneity variance. data points group certain observed heterogeneity variance true feature underlying parent population (therefore problem) rather just caused single random point (therefore problem).","code":"\n# define the linear model, with interaction term\nlm_cells <- lm(cell_number ~ concentration * cell_type,\n          data = cells)\nlm_cells %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)"},{"path":"two-way-anova.html","id":"implement-the-test-1","chapter":"4 Two-way ANOVA","heading":"4.9.4 Implement the test","text":"Let’s carry two-way ANOVA:","code":"\n# perform the ANOVA\nanova(lm_cells)## Analysis of Variance Table\n## \n## Response: cell_number\n##                         Df  Sum Sq Mean Sq F value    Pr(>F)    \n## concentration            2 10932.1  5466.1 537.645 1.807e-12 ***\n## cell_type                1  1152.0  1152.0 113.311 1.816e-07 ***\n## concentration:cell_type  2  1158.3   579.2  56.967 7.485e-07 ***\n## Residuals               12   122.0    10.2                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"interpret-the-output-and-report-the-results","chapter":"4 Two-way ANOVA","heading":"4.9.5 Interpret the output and report the results","text":"definitely significant interaction concentration cell_type.","code":""},{"path":"two-way-anova.html","id":"exercise-tulips","chapter":"4 Two-way ANOVA","heading":"4.10 Exercise: Tulips","text":"Exercise 4.2  Blooms growing conditionsThe data/tidy/CS4-tulip.csv dataset contains information experiment determine best conditions growing tulips (well someone care sorts things!). average number flower heads (blooms) recorded 27 different plots. plot experienced one three different watering regimes one three different shade regimes.Investigate number blooms affected different growing conditions.data set watering regime (water) shading regime (shade) encoded numerical values. However, numbers actually categories, representing amount water/shade., don’t want treat numbers factors. can convert columns using as_factor() function. ’d like keep referring columns factors, update existing data set.dataset three variables; blooms (response variable) water shade (two potential predictor variables).always ’ll visualise data first:, interaction plots suggest might interaction . Digging little deeper descriptive perspective, looks though water regime 1 behaving differently water regimes 2 3 different shade conditions.First need define model:Next, check assumptions:actually OK. Point number 8 messing homogeneity variance assumption little bit, since ’s one point won’t worry . two-way ANOVA analysis still cards.Let’s carry two-way ANOVA.appear significant interaction water shade expected.","code":"\n# read in the data\ntulip <- read_csv(\"data/tidy/CS4-tulip.csv\")## Rows: 27 Columns: 3## ── Column specification ────────────────────────────────────────────────────────\n## Delimiter: \",\"\n## dbl (3): water, shade, blooms## \n## ℹ Use `spec()` to retrieve the full column specification for this data.\n## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n# have a quick look at the data\ntulip## # A tibble: 27 × 3\n##    water shade blooms\n##    <dbl> <dbl>  <dbl>\n##  1     1     1    0  \n##  2     1     2    0  \n##  3     1     3  111. \n##  4     2     1  183. \n##  5     2     2   59.2\n##  6     2     3   76.8\n##  7     3     1  225. \n##  8     3     2   83.8\n##  9     3     3  135. \n## 10     1     1   80.1\n## # … with 17 more rows\n# convert watering and shade regimes to factor\ntulip <- tulip %>% \n  mutate(water = as_factor(water),\n         shade = as_factor(shade))\n# by watering regime\ntulip %>% \n  ggplot(aes(x = water, y = blooms)) +\n  geom_boxplot()\n# by shading regime\ntulip %>% \n  ggplot(aes(x = shade, y = blooms)) +\n  geom_boxplot()\n# interaction plot by watering regime\ntulip %>% \n  ggplot(aes(x = shade,\n             y = blooms,\n             colour = water, group = water)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# interaction plot by shade regime\ntulip %>% \n  ggplot(aes(x = water,\n             y = blooms,\n             colour = shade, group = shade)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# define the linear model\nlm_tulip <- lm(blooms ~ water * shade,\n               data = tulip)\nlm_tulip %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)\n# perform the ANOVA\nanova(lm_tulip)## Analysis of Variance Table\n## \n## Response: blooms\n##             Df Sum Sq Mean Sq F value    Pr(>F)    \n## water        2 103626   51813 22.0542 1.442e-05 ***\n## shade        2  36376   18188  7.7417   0.00375 ** \n## water:shade  4  41058   10265  4.3691   0.01211 *  \n## Residuals   18  42288    2349                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"load-the-data-1","chapter":"4 Two-way ANOVA","heading":"4.10.1 Load the data","text":"data set watering regime (water) shading regime (shade) encoded numerical values. However, numbers actually categories, representing amount water/shade., don’t want treat numbers factors. can convert columns using as_factor() function. ’d like keep referring columns factors, update existing data set.dataset three variables; blooms (response variable) water shade (two potential predictor variables).","code":"\n# read in the data\ntulip <- read_csv(\"data/tidy/CS4-tulip.csv\")## Rows: 27 Columns: 3## ── Column specification ────────────────────────────────────────────────────────\n## Delimiter: \",\"\n## dbl (3): water, shade, blooms## \n## ℹ Use `spec()` to retrieve the full column specification for this data.\n## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n# have a quick look at the data\ntulip## # A tibble: 27 × 3\n##    water shade blooms\n##    <dbl> <dbl>  <dbl>\n##  1     1     1    0  \n##  2     1     2    0  \n##  3     1     3  111. \n##  4     2     1  183. \n##  5     2     2   59.2\n##  6     2     3   76.8\n##  7     3     1  225. \n##  8     3     2   83.8\n##  9     3     3  135. \n## 10     1     1   80.1\n## # … with 17 more rows\n# convert watering and shade regimes to factor\ntulip <- tulip %>% \n  mutate(water = as_factor(water),\n         shade = as_factor(shade))"},{"path":"two-way-anova.html","id":"visualise-the-data-1","chapter":"4 Two-way ANOVA","heading":"4.10.2 Visualise the data","text":"always ’ll visualise data first:, interaction plots suggest might interaction . Digging little deeper descriptive perspective, looks though water regime 1 behaving differently water regimes 2 3 different shade conditions.","code":"\n# by watering regime\ntulip %>% \n  ggplot(aes(x = water, y = blooms)) +\n  geom_boxplot()\n# by shading regime\ntulip %>% \n  ggplot(aes(x = shade, y = blooms)) +\n  geom_boxplot()\n# interaction plot by watering regime\ntulip %>% \n  ggplot(aes(x = shade,\n             y = blooms,\n             colour = water, group = water)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")\n# interaction plot by shade regime\ntulip %>% \n  ggplot(aes(x = water,\n             y = blooms,\n             colour = shade, group = shade)) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  stat_summary(fun = mean, geom = \"line\") +\n  scale_colour_brewer(palette = \"Dark2\")"},{"path":"two-way-anova.html","id":"assumptions-2","chapter":"4 Two-way ANOVA","heading":"4.10.3 Assumptions","text":"First need define model:Next, check assumptions:actually OK. Point number 8 messing homogeneity variance assumption little bit, since ’s one point won’t worry . two-way ANOVA analysis still cards.","code":"\n# define the linear model\nlm_tulip <- lm(blooms ~ water * shade,\n               data = tulip)\nlm_tulip %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)"},{"path":"two-way-anova.html","id":"implement-the-test-2","chapter":"4 Two-way ANOVA","heading":"4.10.4 Implement the test","text":"Let’s carry two-way ANOVA.","code":"\n# perform the ANOVA\nanova(lm_tulip)## Analysis of Variance Table\n## \n## Response: blooms\n##             Df Sum Sq Mean Sq F value    Pr(>F)    \n## water        2 103626   51813 22.0542 1.442e-05 ***\n## shade        2  36376   18188  7.7417   0.00375 ** \n## water:shade  4  41058   10265  4.3691   0.01211 *  \n## Residuals   18  42288    2349                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"two-way-anova.html","id":"interpret-the-output-and-report-results","chapter":"4 Two-way ANOVA","heading":"4.10.5 Interpret the output and report results","text":"appear significant interaction water shade expected.","code":""},{"path":"two-way-anova.html","id":"key-points","chapter":"4 Two-way ANOVA","heading":"4.11 Key points","text":"two-way ANOVA used two categorical variables single continuous variableWe can visually check interactions categorical variables using interaction plotsThe two-way ANOVA type linear model assumes following:\ndata systematic pattern\nresiduals normally distributed\nresiduals homogeneity variance\nfit depend single point (single point high leverage)\ndata systematic patternthe residuals normally distributedthe residuals homogeneity variancethe fit depend single point (single point high leverage)","code":""},{},{"path":"linear-regression-with-grouped-data.html","id":"linear-regression-with-grouped-data","chapter":"5 Linear regression with grouped data","heading":"5 Linear regression with grouped data","text":"","code":""},{"path":"linear-regression-with-grouped-data.html","id":"objectives-2","chapter":"5 Linear regression with grouped data","heading":"5.1 Objectives","text":"QuestionsHow perform linear regression grouped data?ObjectivesBe able perform linear regression grouped data RCalculate linear regression individual groups visualise dataUnderstand able create equations regression lineBe able deal interactions context","code":""},{"path":"linear-regression-with-grouped-data.html","id":"purpose-and-aim-1","chapter":"5 Linear regression with grouped data","heading":"5.2 Purpose and aim","text":"linear regression analysis grouped data used one categorical predictor variable (factor), one continuous predictor variable. response variable must still continuous however.example experiment looks light intensity woodland, light intensity (continuous: lux) affected height measurement taken, recorded depth measured top canopy (continuous: metres) type woodland (categorical: Conifer Broad leaf).analysing type data want know:difference groups?continuous predictor variable affect continuous response variable (canopy depth affect measured light intensity?)interaction two predictor variables? interaction display difference slopes regression lines group, example perhaps conifer dataset significantly steeper line broad leaf woodland dataset.case, interaction means regression lines slope.\nEssentially analysis identical two-way ANOVA (R doesn’t really notice difference).plot data visually inspect .test interaction doesn’t exist :\ncan test see either predictor variable effect (.e. regression lines different intercepts? common gradient significantly different zero?)\ncan test see either predictor variable effect (.e. regression lines different intercepts? common gradient significantly different zero?)first consider visualise data carrying appropriate statistical test.","code":""},{"path":"linear-regression-with-grouped-data.html","id":"section-commands-1","chapter":"5 Linear regression with grouped data","heading":"5.3 Section commands","text":"New commands used section:","code":""},{"path":"linear-regression-with-grouped-data.html","id":"data-and-hypotheses-1","chapter":"5 Linear regression with grouped data","heading":"5.4 Data and hypotheses","text":"data stored data/tidy/CS4-treelight.csv.Read data inspect :treelight data frame four variables; id, light, depth species. light continuous response variable, depth continuous predictor variable species categorical predictor variable.","code":"\n# read in the data\ntreelight <- read_csv(\"data/tidy/CS4-treelight.csv\")\n\n# inspect the data\ntreelight## # A tibble: 23 × 4\n##       id light depth species\n##    <dbl> <dbl> <dbl> <chr>  \n##  1     1 4106.  1    Conifer\n##  2     2 4934.  1.75 Conifer\n##  3     3 4417.  2.5  Conifer\n##  4     4 4529.  3.25 Conifer\n##  5     5 3443.  4    Conifer\n##  6     6 4640.  4.75 Conifer\n##  7     7 3082.  5.5  Conifer\n##  8     8 2368.  6.25 Conifer\n##  9     9 2777.  7    Conifer\n## 10    10 2419.  7.75 Conifer\n## # … with 13 more rows"},{"path":"linear-regression-with-grouped-data.html","id":"summarise-and-visualise-1","chapter":"5 Linear regression with grouped data","heading":"5.5 Summarise and visualise","text":"looks like slight negative correlation depth light intensity, light intensity reducing canopy depth increases. useful plot regression lines plot. can follows, updating code:Looking plot, doesn’t appear significant interaction woodland type (Broadleaf Conifer) depth light measurements taken (depth) amount light intensity getting canopy gradients two lines appear similar. appear noticeable slope lines lines look though different intercepts. suggests isn’t interaction depth species significant effect Light independently.","code":"\n# plot the data\ntreelight %>% \n  ggplot(aes(x = depth, y = light, colour = species)) +\n  geom_point() +\n  scale_color_brewer(palette = \"Dark2\") +\n  labs(x = \"Depth (m)\",\n       y = \"Light intensity (lux)\")\n# plot the data\ntreelight %>% \n  ggplot(aes(x = depth, y = light, colour = species)) +\n  geom_point() +\n  # add regression lines\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_color_brewer(palette = \"Dark2\") +\n  labs(x = \"Depth (m)\",\n       y = \"Light intensity (lux)\")"},{"path":"linear-regression-with-grouped-data.html","id":"implement-the-test-3","chapter":"5 Linear regression with grouped data","heading":"5.6 Implement the test","text":"case ’re going implement test checking assumptions (know, let’s live little!). ’ll find soon…can test possible interaction formally:Remember depth * species shorthand way writing full set depth + species + depth:species terms R .e. main effects interaction effect.","code":"\nanova(lm(light ~ depth * species,\n         data = treelight))"},{"path":"linear-regression-with-grouped-data.html","id":"interpret-output-and-present-results-1","chapter":"5 Linear regression with grouped data","heading":"5.7 Interpret output and present results","text":"gives following output:two-way ANOVA row table different effects ’ve asked R consider. last column important one contains p-values. need look interaction row first.\ndepth:species p-value 0.393 (bigger 0.05) can conclude interaction depth species isn’t significant. can now consider whether predictor variables independently effect. depth species small p-values (2.86x10-9 4.13x10 -11) can conclude significant effect light.means two regression lines non-zero slope, different intercepts. now like know values .","code":"## Analysis of Variance Table\n## \n## Response: light\n##               Df   Sum Sq  Mean Sq  F value    Pr(>F)    \n## depth          1 30812910 30812910 107.8154 2.861e-09 ***\n## species        1 51029543 51029543 178.5541 4.128e-11 ***\n## depth:species  1   218138   218138   0.7633    0.3932    \n## Residuals     19  5430069   285793                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"linear-regression-with-grouped-data.html","id":"finding-intercept-values","chapter":"5 Linear regression with grouped data","heading":"5.7.1 Finding intercept values","text":"Unfortunately, R doesn’t make obvious easy us deciphering required getting right.\nsimple straight line linear regression conifer dataset , output relatively straightforward.can interpret meaning intercept regression line 5014 coefficient depth variable (number front equation) -292.2., equation regression line given :\\[\\begin{equation}\nLight = 5014 + -292.2 \\cdot Depth\n\\end{equation}\\]came fitting simple linear model using conifer dataset, meaning every extra 1 m depth forest canopy lose 292.2 lux light.looked full dataset, found interaction wasn’t important. means model two distinct intercepts single slope (’s get linear regression without interaction), need ask R calculate specific combination. command simply:Notice + symbol argument, opposed * symbol used earlier. means explicitly including interaction term fit, consequently forcing R calculate equation lines gradient.Ideally like R give us two equations, one forest type, four parameters total.\nUnfortunately, R parsimonious doesn’t . Instead R gives three coefficients, require bit interpretation.first two numbers R returns (underneath Intercept depth) exact intercept slope coefficients one lines (case correspond data Broadleaf woodlands).coefficients belonging line, R uses first two coefficients baseline values expresses coefficients relative ones. R also doesn’t tell explicitly group using baseline reference group! (mention R can helpful times 😉?), decipher output?First, need work group used baseline.group comes first alphabetically, BroadleafThe way check look see group mentioned table. Conifer mentioned (SpeciesConifer heading) baseline group Broadleaf.means intercept value depth coefficient correspond Broadleaf group result know equation one lines :Broadleaf:\\[\\begin{equation}\nLight = 7962 + -262.2 \\cdot Depth\n\\end{equation}\\]example know gradient lines (explicitly asked R include interaction), need find intercept value Conifer group. Unfortunately, final value given underneath SpeciesConifer give intercept Conifer, instead tells difference Conifer group intercept baseline intercept .e. equation regression line conifer woodland given :\\[\\begin{equation}\nLight = (7962 + -3113) + -262.2 \\cdot Depth\n\\end{equation}\\]\\[\\begin{equation}\nLight = 4829 + -262.2 \\cdot Depth\n\\end{equation}\\]","code":"\n# filter the Conifer data and fit a linear model\ntreelight %>% \n  filter(species == \"Conifer\") %>% \n  lm(light ~ depth, data = .)## \n## Call:\n## lm(formula = light ~ depth, data = .)\n## \n## Coefficients:\n## (Intercept)        depth  \n##      5014.0       -292.2\nlm(light ~ depth + species,\n   data = treelight)## \n## Call:\n## lm(formula = light ~ depth + species, data = treelight)\n## \n## Coefficients:\n##    (Intercept)           depth  speciesConifer  \n##         7962.0          -262.2         -3113.0"},{"path":"linear-regression-with-grouped-data.html","id":"adding-custom-regression-lines","chapter":"5 Linear regression with grouped data","heading":"5.7.2 Adding custom regression lines","text":"example determined interaction term species:depth significant. good visualise model without interaction term.relatively straightforward understand output model bit better.First , load broom library. part tidyverse, don’t install . loaded default, hence us loading . broom changes format many common base R outputs tidy format, can work output analyses easily.function use called augment(). take model object dataset adds information observation dataset.output shows us lots data. original light values light column ’s species depth. added information fitted (predicted) values based light ~ depth + species model defined.fitted predicted values .fitted column, corresponding residuals .resid column. Remember, data = predicted values + error, add .fitted + resid end original data .Using information can now plot regression lines species:Lastly, want plot data regression lines together, change code follows:","code":"\n# define the model without interaction term\nlm_additive <- lm(light ~ species + depth,\n                  data = treelight)\n\n# load the broom package\nlibrary(broom)\n\n# augment the model\nlm_additive %>% augment()## # A tibble: 23 × 9\n##    light species depth .fitted .resid   .hat .sigma .cooksd .std.resid\n##    <dbl> <chr>   <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>      <dbl>\n##  1 4106. Conifer  1      4587.  -481. 0.191    531. 0.0799      -1.01 \n##  2 4934. Conifer  1.75   4390.   544. 0.156    528. 0.0766       1.11 \n##  3 4417. Conifer  2.5    4194.   223. 0.128    542. 0.00985      0.449\n##  4 4529. Conifer  3.25   3997.   532. 0.105    530. 0.0440       1.06 \n##  5 3443. Conifer  4      3800.  -358. 0.0896   538. 0.0163      -0.706\n##  6 4640. Conifer  4.75   3604.  1037. 0.0801   486. 0.120        2.03 \n##  7 3082. Conifer  5.5    3407.  -325. 0.0769   540. 0.0113      -0.637\n##  8 2368. Conifer  6.25   3210.  -842. 0.0801   507. 0.0793      -1.65 \n##  9 2777. Conifer  7      3014.  -237. 0.0896   542. 0.00719     -0.468\n## 10 2419. Conifer  7.75   2817.  -398. 0.105    537. 0.0247      -0.792\n## # … with 13 more rows\n# plot the regression lines by species\nlm_additive %>%\n  augment() %>% \n  ggplot(aes(x = depth, y = .fitted, colour = species)) +\n  geom_line() +\n  scale_color_brewer(palette = \"Dark2\")\n# plot the regression lines\nlm_additive %>%\n  augment() %>% \n  ggplot(aes(x = depth, y = .fitted, colour = species)) +\n  # add the original data points\n  geom_point(data = treelight,\n             aes(x = depth, y = light, colour = species)) +\n  geom_line() +\n  scale_color_brewer(palette = \"Dark2\") +\n  labs(x = \"Depth (m)\",\n       y = \"Light intensity (lux)\")"},{"path":"linear-regression-with-grouped-data.html","id":"assumptions-3","chapter":"5 Linear regression with grouped data","heading":"5.8 Assumptions","text":"case first wanted check interaction significant, prior checking assumptions. checked assumptions first, done one full model (interaction), done ANOVA everything OK. found interaction significant, meaning ’d re-check assumptions new model. order bit less important . main thing check assumptions report !Anyway, hopefully ’ve got gist checking assumptions linear models now: diagnostic plots!Residuals plot looks OK, systematic pattern.Q-Q plot isn’t perfect, ’m happy normality assumption.Location-Scale plot OK, slight suggestion heterogeneity variance, nothing worried .Cook’s D plot shows points OKWoohoo!","code":"\nlm_additive %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)"},{"path":"linear-regression-with-grouped-data.html","id":"dealing-with-interaction","chapter":"5 Linear regression with grouped data","heading":"5.9 Dealing with interaction","text":"significant interaction two predictor variables (example, light intensity dropped significantly faster conifer woods broad leaf woods, addition lower overall, looking two equations linear regression, time gradients vary well.\ncase interaction important need output linear regression explicitly includes interaction term:written using short-hand:really absolutely difference end result.\nEither way gives us following output:Broadleaf line used baseline regression can read values intercept slope directly:Broadleaf:\n\\[\\begin{equation}\nLight = 7798.57 + -221.13 \\cdot Depth\n\\end{equation}\\]Note different previous section, allowing interaction fitted values change.conifer line different intercept value different gradient value. value underneath speciesConifer gives us difference intercept conifer line broad leaf line. new, additional term depth:speciesConifer tells us coefficient depth varies conifer line .e. gradient different. Putting two together gives us following equation regression line conifer woodland:Conifer:\n\\[\\begin{equation}\nLight = (7798.57 + -2784.58) + (-221.13 + -71.04) \\cdot Depth\n\\end{equation}\\]\\[\\begin{equation}\nLight = 5014 + -292.2 \\cdot Depth\n\\end{equation}\\]also happen exactly regression lines get calculating linear regression group’s data separately.","code":"\nlm(light ~ depth + species + depth:species,\n   data = treelight)\nlm(light ~ depth * species,\n   data = treelight)## \n## Call:\n## lm(formula = light ~ depth * species, data = treelight)\n## \n## Coefficients:\n##          (Intercept)                 depth        speciesConifer  \n##              7798.57               -221.13              -2784.58  \n## depth:speciesConifer  \n##               -71.04"},{"path":"linear-regression-with-grouped-data.html","id":"exercise-clover-and-yarrow","chapter":"5 Linear regression with grouped data","heading":"5.10 Exercise: Clover and yarrow","text":"Exercise 5.1  Clover yarrow field trialsThe data/tidy/CS4-clover.csv dataset contains information field trials three different farms (, B C). farm recorded yield clover ten fields along density yarrow stalks field.Investigate clover yield affected yarrow stalk density. evidence competition two species?difference farms?dataset three variables; yield (response variable), yarrow (continuous predictor variable) farm (categorical predictor variables). always ’ll visualise data first:Looking plot stands, ’s pretty clear yarrow density significant effect yield, ’s pretty hard see plot whether effect farm, whether interaction. order work ’ll want add regression lines farm separately.regression lines close together, looks much isn’t interaction, also isn’t effect farm. Let’s carry analysis:confirms suspicions looking plot. isn’t interaction yarrow farm. yarrow density statistically significant effect yield isn’t difference different farms yields clover.Let’s check assumptions:borderline case.Normality fine (Q-Q plot)aren’t highly influential points (Cook’s D plot)strong suggestion heterogeneity variance (Location-Scale plot). points relatively close regression lines, much great spread points low yarrow density (corresponds high yield values, predicted values correspond ).Finally, slight suggestion data might linear, might curve slightly (Residual plot).two options; arguably OK real life.can claim assumptions well enough met just report analysis ’ve just done.can decide analysis appropriate look options.\ncan try transform data taking logs yield. might fix problems: taking logs response variable effect improving heterogeneity variance Residuals plot spread right vs. left (like ). also appropriate think true relationship response predictor variables exponential rather linear (might ). capabilities try option.\ntry permutation based approach (beyond remit course, actually bit tricky situation). wouldn’t address non-linearity deal variance assumption.\ncome specific functional, mechanistic relationship yarrow density clover yield based upon aspects biology. example might threshold effect yarrow densities particular value, clover yields unaffected, soon yarrow values get threshold clover yield decreases (maybe even linearly). require much better understanding clover-yarrow dynamics (personally know little).\ncan try transform data taking logs yield. might fix problems: taking logs response variable effect improving heterogeneity variance Residuals plot spread right vs. left (like ). also appropriate think true relationship response predictor variables exponential rather linear (might ). capabilities try option.try permutation based approach (beyond remit course, actually bit tricky situation). wouldn’t address non-linearity deal variance assumption.come specific functional, mechanistic relationship yarrow density clover yield based upon aspects biology. example might threshold effect yarrow densities particular value, clover yields unaffected, soon yarrow values get threshold clover yield decreases (maybe even linearly). require much better understanding clover-yarrow dynamics (personally know little).Let’s quick little transformation data, repeat analysis see assumptions better met time (just hell ):, looks plausible. ’s noticeable outlier Farm B (data point bottom plot) otherwise see : probably isn’t interaction; likely effect yarrow log(yield); probably isn’t difference farms.Let’s analysis:Woop. good far. conclusions terms significant isn’t. Now just need check assumptions:Well, actually better set diagnostic plots. Whilst one data point (example Q-Q plot) clear outlier, ignore point plots look better.now know yarrow significant predictor yield ’re happy assumptions met.","code":"\nclover <- read_csv(\"data/tidy/CS4-clover.csv\")\n# plot the data\nclover %>% \n  ggplot(aes(x = yarrow, y = yield,\n             colour = farm)) +\n  geom_point() +\n  scale_color_brewer(palette = \"Dark2\")\n# plot the data\nclover %>% \n  ggplot(aes(x = yarrow, y = yield,\n             colour = farm, group = farm)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_color_brewer(palette = \"Dark2\")\nlm_clover <- lm(yield ~ yarrow * farm,\n                data = clover)\n\nanova(lm_clover)## Analysis of Variance Table\n## \n## Response: yield\n##             Df Sum Sq Mean Sq F value    Pr(>F)    \n## yarrow       1 8538.3  8538.3 28.3143 1.847e-05 ***\n## farm         2    3.8     1.9  0.0063    0.9937    \n## yarrow:farm  2  374.7   187.4  0.6213    0.5457    \n## Residuals   24 7237.3   301.6                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nlm_clover %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)\n# plot log-transformed data\nclover %>% \n  ggplot(aes(x = yarrow, y = log(yield), colour = farm)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_color_brewer(palette = \"Dark2\")\n# define linear model\nlm_log_clover <- lm(log(yield) ~ yarrow * farm,\n                    data = clover)\n\nanova(lm_log_clover)## Analysis of Variance Table\n## \n## Response: log(yield)\n##             Df  Sum Sq Mean Sq F value   Pr(>F)    \n## yarrow       1 10.6815 10.6815 27.3233 2.34e-05 ***\n## farm         2  0.0862  0.0431  0.1103   0.8960    \n## yarrow:farm  2  0.8397  0.4199  1.0740   0.3575    \n## Residuals   24  9.3823  0.3909                     \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nlm_log_clover %>% \n  resid_panel(plots = c(\"resid\", \"qq\", \"ls\", \"cookd\"),\n              smoother = TRUE)"},{"path":"linear-regression-with-grouped-data.html","id":"key-points-1","chapter":"5 Linear regression with grouped data","heading":"5.11 Key points","text":"linear regression analysis grouped data used one categorical one continuous predictor variable, together one continuous response variableWe can visualise data plotting regression line together raw dataWhen performing ANOVA, need check interaction termsAgain, check underlying assumptions using diagnostic plotsWe can create equation regression line group data using lm() output","code":""}]
