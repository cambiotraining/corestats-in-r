<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Two-sample tests | Core Statistics in R</title>
<meta name="author" content="Matt Castle and Martin van Rongen">
<meta name="description" content="7.1 Objectives  Questions When do I perform a two-sample test? Which two-sample tests are there and what are the assumptions? How do I interpret and present the results of the tests? Objectives...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 7 Two-sample tests | Core Statistics in R">
<meta property="og:type" content="book">
<meta property="og:description" content="7.1 Objectives  Questions When do I perform a two-sample test? Which two-sample tests are there and what are the assumptions? How do I interpret and present the results of the tests? Objectives...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Two-sample tests | Core Statistics in R">
<meta name="twitter:description" content="7.1 Objectives  Questions When do I perform a two-sample test? Which two-sample tests are there and what are the assumptions? How do I interpret and present the results of the tests? Objectives...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">
  <div class="header">
    <div class="inline-table"><table class="top-menu"><tr>
<td>
          <div class="logo">
            <img src="img/main-logo-homepage.svg" alt="University of Cambridge" height="38px;">
</div>
        </td>
        <td class="top-menu"><a href="index.html">Course home page</a></td>
        <td class="top-menu"><a href="https://www.training.cam.ac.uk/bioinformatics/search?type=events&amp;query=&amp;_action_search=Search&amp;_pastEvents=">Planned courses</a></td>
        <td class="top-menu">
          <a href="https://bioinfotraining.bio.cam.ac.uk">Bioinformatics Training Facility</a>
        </td>
        <td class="top-menu-right"> </td>
      </tr></table></div>
</div>
<div class="body-bg"></div> <!-- .body-bg -->

<div class="container-fluid">
  <!-- Menu above dynamic content -->
  <div class="container-menu">
  <div class="inline-table"><table class="container-menu"><tr>
<td class="container-menu"><a href="index.html" title="">Core Statistics in R</a></td>
        <td class="container-menu"><a href="https://www.training.cam.ac.uk/bioinformatics/search?type=events&amp;query=&amp;_action_search=Search&amp;_pastEvents=">Planned courses</a></td>
        <td class="container-menu">
          <a href="https://bioinfotraining.bio.cam.ac.uk">Bioinformatics Training Facility</a>
        </td>
        <td class="container-menu-right"> </td>
      </tr></table></div>
</div>

<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Core Statistics in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="searchbar">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      </div>
      <div class="menu-items" width="100%">
      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Overview</a></li>
<li class="book-part">CoreStats 1: Simple hypothesis testing</li>
<li><a class="" href="cs1-intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li class="book-part">CoreStats 1 (Practicals)</li>
<li><a class="" href="introduction.html"><span class="header-section-number">3</span> Introduction</a></li>
<li><a class="" href="cs1-one-sample-tests.html"><span class="header-section-number">4</span> One-sample tests</a></li>
<li><a class="" href="cs1-one-sample-t-test.html"><span class="header-section-number">5</span> 1-sample t-test</a></li>
<li><a class="" href="cs1-onesample-wilcoxon-signed-rank.html"><span class="header-section-number">6</span> Wilcoxon signed-rank test</a></li>
<li><a class="active" href="cs1-two-sample.html"><span class="header-section-number">7</span> Two-sample tests</a></li>
<li><a class="" href="cs1-students-t-test.html"><span class="header-section-number">8</span> Student’s t-test</a></li>
<li><a class="" href="cs1-mannwhitney-u-test.html"><span class="header-section-number">9</span> Mann-Whitney U test</a></li>
<li><a class="" href="cs1-paired-two-sample-t-test.html"><span class="header-section-number">10</span> Paired two-sample t-test</a></li>
<li><a class="" href="cs1-twosample-wilcoxon-signed-rank.html"><span class="header-section-number">11</span> Wilcoxon signed-rank test</a></li>
<li class="book-part">CoreStats 2: Single categorical predictors</li>
<li><a class="" href="cs2-intro.html"><span class="header-section-number">12</span> Introduction</a></li>
<li class="book-part">CoreStats 2 (Practicals)</li>
<li><a class="" href="introduction-1.html"><span class="header-section-number">13</span> Introduction</a></li>
<li><a class="" href="cs2-anova.html"><span class="header-section-number">14</span> ANOVA</a></li>
<li><a class="" href="kruskal-wallis-test.html"><span class="header-section-number">15</span> Kruskal-Wallis test</a></li>
<li class="book-part">CoreStats 3: Single continuous predictors</li>
<li><a class="" href="cs3-intro.html"><span class="header-section-number">16</span> Introduction</a></li>
<li class="book-part">CoreStats 3 (Practicals)</li>
<li><a class="" href="introduction-2.html"><span class="header-section-number">17</span> Introduction</a></li>
<li><a class="" href="correlation-coefficients.html"><span class="header-section-number">18</span> Correlation coefficients</a></li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">19</span> Linear regression</a></li>
<li class="book-part">CoreStats 4: Two predictor variables</li>
<li><a class="" href="cs4-intro.html"><span class="header-section-number">20</span> Introduction</a></li>
<li class="book-part">CoreStats 4 (Practicals)</li>
<li><a class="" href="introduction-3.html"><span class="header-section-number">21</span> Introduction</a></li>
<li><a class="" href="two-way-anova.html"><span class="header-section-number">22</span> Two-way ANOVA</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/cambiotraining/corestats_in_r">View book source <i class="fab fa-github"></i></a></p>
        </div>
        </nav>
</div>
      
    </div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cs1-two-sample" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Two-sample tests<a class="anchor" aria-label="anchor" href="#cs1-two-sample"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives-2" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives-2"><i class="fas fa-link"></i></a>
</h2>
<div class="objectives">
<p><strong>Questions</strong></p>
<ul>
<li>When do I perform a two-sample test?</li>
<li>Which two-sample tests are there and what are the assumptions?</li>
<li>How do I interpret and present the results of the tests?</li>
</ul>
<p><strong>Objectives</strong></p>
<ul>
<li>Set out your hypothesis for two-sample continuous data</li>
<li>Determine the correct data format to perform a two-sample test in R</li>
<li>Summarise and visualise the data</li>
<li>Check underlying assumptions (normality, homogeneity of variance)</li>
<li>Be able to choose an appropriate two-sample test and run it in R</li>
<li>Be able to interpret and report the results</li>
</ul>
</div>
</div>
<div id="purpose-and-aim-1" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Purpose and aim<a class="anchor" aria-label="anchor" href="#purpose-and-aim-1"><i class="fas fa-link"></i></a>
</h2>
<p>These tests are used when we have two samples of continuous data where we are trying to find out if the samples came from the same parent distribution or not. This essentially boils down to finding out if there is a difference in the means of the two samples.</p>
</div>
<div id="two-sample-choosing-a-test" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Choosing a test<a class="anchor" aria-label="anchor" href="#two-sample-choosing-a-test"><i class="fas fa-link"></i></a>
</h2>
<p>There are five key tests that can be used to deal with two samples. Choosing which test to use depends upon which key assumptions are satisfied by your sample data and this effectively boils down to answering four questions about your samples:</p>
<ol style="list-style-type: decimal">
<li>Are the samples normally distributed? (Yes/No)</li>
<li>How big are your samples? (&lt;30 data points or &gt;30 data points)</li>
<li>Are the samples paired? (Yes/No)</li>
<li>Do the samples have the same variance? (Yes/No)</li>
</ol>
<p>There are two sets of tests to consider depending on your answers to questions 1 and 2. If your data are normally distributed or if you have big samples then you need to look at the parametric tests. If your data are not normally distributed <em>and</em> your sample size is small, then you need to look at non-parametric tests (see Figure <a href="cs1-two-sample.html#fig:fig-cs1-diagram-test">7.1</a>. Questions 3 and 4 then help you pick the specific test to use, which is summarised in Figure <a href="cs1-two-sample.html#fig:fig-cs1-diagram-which-test">7.2</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-cs1-diagram-test"></span>
<img src="img/cs1-diagram-test.svg" alt="Category of test"><p class="caption">
Figure 7.1: Category of test
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-cs1-diagram-which-test"></span>
<img src="img/cs1-diagram-which-test.svg" alt="Which test to use"><p class="caption">
Figure 7.2: Which test to use
</p>
</div>
<ol style="list-style-type: decimal">
<li>Testing whether a sample comes from a normal distribution was covered in <a href="cs1-one-sample-tests.html#cs1-one-sample-tests">One-sample tests</a>. You need to visualise your data and/or use the Shapiro-Wilk test.</li>
<li>The size of the sample makes things easier. Because of maths (specifically due to something called the central limit theorem which I am not even going to attempt to touch upon here) if you have large samples then you can use the tests that assume normality of the parent population (Student’s t-test, Welch’s t-test and the paired t-test) even if your parent populations are certainly not normal. If you really want to understand exactly why this works, then you will have to do some more rigorous mathematics. So, for the moment I’m going to say that it’s OK to take these facts on faith and just trust me on this.</li>
<li>Paired samples mean that for every data point in one sample there is a matching data point in the other sample that is linked to it in some inextricable way. A typical example would involve a group of 20 test subjects being measured before and after some experiment. Providing that the experiment didn’t do anything fatal to the test subjects then the data would consist of two samples; 20 pre-experiment measurements and 20 post-experiment measurements. However, because the same test subjects were used then each pre-experiment data point can be matched exactly to one of the post-experiment data points. In this sense the two samples are said to be “paired.”</li>
<li>There are a couple of tests (Bartlett’s test and Levene’s test) that can be used to see if two samples come from distributions with the same variance. These will be covered in a later section.</li>
<li>Resampling techniques aren’t covered in this course and require a mixture of statistical understanding and programming skill. Ask a demonstrator (or Google it 😉) if you want to know more.</li>
</ol>
</div>
<div id="tidy-data" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Tidy data<a class="anchor" aria-label="anchor" href="#tidy-data"><i class="fas fa-link"></i></a>
</h2>
<p>For two samples the data can be stored in one of three formats in R:</p>
<ol style="list-style-type: decimal">
<li>as two separate vectors,</li>
<li>in a stacked data frame,</li>
<li>or in an unstacked data frame/list.</li>
</ol>
<p>Two separate vectors case is (hopefully) obvious.</p>
<p>When using a data frame we have different options to organise our data. The best way of formatting data in R is by using <a href="https://r4ds.had.co.nz/tidy-data.html">the tidy data format</a>.</p>
<div class="highlight">
<p><strong>Tidy data</strong> has the following properties:</p>
<ul>
<li>Each variable has its own column</li>
<li>Each observation has its own row</li>
<li>Each value has its own cell</li>
</ul>
</div>
<p>Stacked form (or <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">long format data</a>) is where the data is arranged in such a way that each variable (thing that we measured) has its own column. If we consider a dataset containing meerkat weights (in g) from two different countries then a stacked format of the data would look like:</p>
<div class="inline-table"><table class="table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
weight
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Botswana
</td>
<td style="text-align:right;">
514
</td>
</tr>
<tr>
<td style="text-align:left;">
Botswana
</td>
<td style="text-align:right;">
568
</td>
</tr>
<tr>
<td style="text-align:left;">
Botswana
</td>
<td style="text-align:right;">
519
</td>
</tr>
<tr>
<td style="text-align:left;">
Uganda
</td>
<td style="text-align:right;">
624
</td>
</tr>
<tr>
<td style="text-align:left;">
Uganda
</td>
<td style="text-align:right;">
662
</td>
</tr>
<tr>
<td style="text-align:left;">
Uganda
</td>
<td style="text-align:right;">
633
</td>
</tr>
</tbody>
</table></div>
<p>In the unstacked (or <a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">wide format</a>) form a variable (measured thing) is present in more than one column. For example, let’s say we measured meerkat weight in two countries over a period of years. We could then organise our data in such a way that for each year the measured values are split by country:</p>
<div class="inline-table"><table class="table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
Botswana
</th>
<th style="text-align:right;">
Uganda
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1990
</td>
<td style="text-align:right;">
514
</td>
<td style="text-align:right;">
624
</td>
</tr>
<tr>
<td style="text-align:right;">
1992
</td>
<td style="text-align:right;">
568
</td>
<td style="text-align:right;">
662
</td>
</tr>
<tr>
<td style="text-align:right;">
1995
</td>
<td style="text-align:right;">
519
</td>
<td style="text-align:right;">
633
</td>
</tr>
</tbody>
</table></div>
<p>Having tidy data is the easiest way of doing analyses in R and I would strongly encourage you all to start adopting this format as standard for data collection and processing.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cs1-onesample-wilcoxon-signed-rank.html"><span class="header-section-number">6</span> Wilcoxon signed-rank test</a></div>
<div class="next"><a href="cs1-students-t-test.html"><span class="header-section-number">8</span> Student’s t-test</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cs1-two-sample"><span class="header-section-number">7</span> Two-sample tests</a></li>
<li><a class="nav-link" href="#objectives-2"><span class="header-section-number">7.1</span> Objectives</a></li>
<li><a class="nav-link" href="#purpose-and-aim-1"><span class="header-section-number">7.2</span> Purpose and aim</a></li>
<li><a class="nav-link" href="#two-sample-choosing-a-test"><span class="header-section-number">7.3</span> Choosing a test</a></li>
<li><a class="nav-link" href="#tidy-data"><span class="header-section-number">7.4</span> Tidy data</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/cambiotraining/corestats_in_r/blob/master/cs1-practical-two_sample.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/cambiotraining/corestats_in_r/edit/master/cs1-practical-two_sample.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->


<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Core Statistics in R</strong>" was written by Matt Castle and Martin van Rongen. It was last built on 2021-10-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
